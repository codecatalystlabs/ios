{{define "content"}}
<div class="container mt-4">
    <h2>VHF Case Investigation Form - Laboratory</h2>
    <form action="/vhf-cif/laboratory/{{.PatientID}}" method="POST" class="needs-validation" novalidate>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="sample_collection_date" class="form-label">Sample Collection Date</label>
                <input type="date" class="form-control" id="sample_collection_date" name="sample_collection_date">
            </div>
            <div class="col-md-6 mb-3">
                <label for="sample_collection_time" class="form-label">Sample Collection Time</label>
                <input type="time" class="form-control" id="sample_collection_time" name="sample_collection_time">
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="sample_type" class="form-label">Sample Type</label>
                <select class="form-select" id="sample_type" name="sample_type">
                    <option value="">Select sample type</option>
                    <option value="Blood">Blood</option>
                    <option value="Urine">Urine</option>
                    <option value="Stool">Stool</option>
                    <option value="Sputum">Sputum</option>
                    <option value="CSF">CSF</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="col-md-6 mb-3">
                <label for="other_sample_type" class="form-label">Other Sample Type</label>
                <input type="text" class="form-control" id="other_sample_type" name="other_sample_type">
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 mb-3">
                <label for="requested_test" class="form-label">Requested Test</label>
                <select class="form-select" id="requested_test" name="requested_test" multiple>
                    <option value="Ebola">Ebola</option>
                    <option value="Marburg">Marburg</option>
                    <option value="Lassa">Lassa</option>
                    <option value="Crimean-Congo">Crimean-Congo</option>
                    <option value="Rift Valley">Rift Valley</option>
                    <option value="Yellow Fever">Yellow Fever</option>
                    <option value="Dengue">Dengue</option>
                    <option value="Other">Other</option>
                </select>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="serology" class="form-label">Serology</label>
                <select class="form-select" id="serology" name="serology">
                    <option value="">Select result</option>
                    <option value="Positive">Positive</option>
                    <option value="Negative">Negative</option>
                    <option value="Pending">Pending</option>
                    <option value="Not Done">Not Done</option>
                </select>
            </div>
            <div class="col-md-4 mb-3">
                <label for="malaria_rdt" class="form-label">Malaria RDT</label>
                <select class="form-select" id="malaria_rdt" name="malaria_rdt">
                    <option value="">Select result</option>
                    <option value="Positive">Positive</option>
                    <option value="Negative">Negative</option>
                    <option value="Pending">Pending</option>
                    <option value="Not Done">Not Done</option>
                </select>
            </div>
            <div class="col-md-4 mb-3">
                <label for="hiv_rdt" class="form-label">HIV RDT</label>
                <select class="form-select" id="hiv_rdt" name="hiv_rdt">
                    <option value="">Select result</option>
                    <option value="Positive">Positive</option>
                    <option value="Negative">Negative</option>
                    <option value="Pending">Pending</option>
                    <option value="Not Done">Not Done</option>
                </select>
            </div>
        </div>

        <div class="mt-4">
            <button type="submit" class="btn btn-primary">Next: Investigator</button>
        </div>
    </form>
</div>

<script>
// Form validation
(function () {
    'use strict'
    var forms = document.querySelectorAll('.needs-validation')
    Array.prototype.slice.call(forms).forEach(function (form) {
        form.addEventListener('submit', function (event) {
            if (!form.checkValidity()) {
                event.preventDefault()
                event.stopPropagation()
            }
            form.classList.add('was-validated')
        }, false)
    })
})()

// Show/hide other sample type field based on selection
document.getElementById('sample_type').addEventListener('change', function() {
    var otherSampleType = document.getElementById('other_sample_type');
    otherSampleType.style.display = this.value === 'Other' ? 'block' : 'none';
});
</script>
{{end}} 